/* 
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘                                                                              â•‘
  â•‘                    ğŸ” FIRESTORE SECURITY RULES ğŸ”                           â•‘
  â•‘                                                                              â•‘
  â•‘  Paste these rules in Firebase Console â†’ Firestore â†’ Rules tab              â•‘
  â•‘                                                                              â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
*/

service cloud.firestore {
  match /databases/{database}/documents {
    // ColecciÃ³n de usuarios
    match /users/{userId} {
      // El usuario solo puede leer/escribir sus propios datos
      allow read, write: if request.auth != null && request.auth.uid == userId;

      // SubcolecciÃ³n de entries (reflexiones/oraciones)
      match /entries/{entryId} {
        // Permitir leer/escribir solo si es el dueÃ±o (userId coincide)
        allow read, write: if request.auth != null && request.auth.uid == userId;

        // Permitir crear si estÃ¡ autenticado (se validarÃ¡ userId en el cÃ³digo)
        allow create: if request.auth != null;
      }
    }

    // ColecciÃ³n pÃºblica de estadÃ­sticas globales (opcional, para futuros anÃ¡lisis)
    match /stats/{document=**} {
      allow read: if request.auth != null;
      allow write: if false; // Solo cambios desde backend/admin
    }
  }
}

/*
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ“‹ EXPLICACIÃ“N DE LAS REGLAS:

  1. /users/{userId}
     â€¢ Solo el usuario dueÃ±o de ese ID puede leer/escribir en su documento
     â€¢ Previene que otros usuarios accedan a informaciÃ³n personal

  2. /users/{userId}/entries/{entryId}
     â€¢ Las reflexiones y oraciones son 100% privadas
     â€¢ Solo el dueÃ±o puede leerlas o modificarlas
     â€¢ Esto garantiza la privacidad de las reflexiones espirituales

  3. ValidaciÃ³n combinada
     â€¢ request.auth != null â†’ Requiere estar autenticado
     â€¢ request.auth.uid == userId â†’ Valida que sea el dueÃ±o

  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ”’ BENEFICIOS DE SEGURIDAD:

  âœ“ Los usuarios NO pueden ver reflexiones de otros
  âœ“ Los usuarios NO pueden modificar o eliminar reflexiones ajenas
  âœ“ Datos completamente privados y seguros
  âœ“ Cumple con GDPR (protecciÃ³n de datos personales)
  âœ“ Ideal para contenido sensible como oraciones y reflexiones espirituales

  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
*/
